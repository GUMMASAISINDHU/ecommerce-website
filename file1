pipeline {
    agent any

    stages {
        stage('Select Branch and Commit') {
            steps {
                script {
                    // Get the branches from the repository
                    def branches = sh(script: "git ls-remote --heads https://github.com/GUMMASAISINDHU/ecommerce-website.git | awk '{print \$2}' | sed 's|refs/heads/||'", returnStdout: true).trim().split("\n")
                    
                    // Allow user to select a branch
                    def selectedBranch = input message: 'Select a branch', parameters: [choice(name: 'BRANCH_NAME', choices: branches.join("\n"), description: 'Select the Git branch')]

                    // Get the commit IDs for the selected branch
                    def commits = sh(script: "git ls-remote https://github.com/GUMMASAISINDHU/ecommerce-website.git refs/heads/${selectedBranch} | awk '{print \$1}'", returnStdout: true).trim().split("\n")
                    
                    // Allow user to select a commit ID
                    def selectedCommit = input message: 'Select a commit', parameters: [choice(name: 'COMMIT_ID', choices: commits.join("\n"), description: 'Select the commit ID')]

                    echo "Selected Branch: ${selectedBranch}"
                    echo "Selected Commit ID: ${selectedCommit}"

                    // Checkout the specific commit from the selected branch
                    checkout([
                        $class: 'GitSCM',
                        branches: [[name: "${selectedCommit}"]],
                        userRemoteConfigs: [[url: 'https://github.com/GUMMASAISINDHU/ecommerce-website.git']],
                        extensions: [[$class: 'LocalBranch', localBranch: "${selectedBranch}"]]
                    ])
                }
            }
        }
        
        // Additional stages can be added here
    }
}

pipeline {
    agent any
 
    stages {
        stage('Checkout') {
            steps {
                script {
                    // Fetch the latest commit IDs from the specified branch
                    def gitUrl = "https://github.com/GUMMASAISINDHU/ecommerce-website.git"
                    def branchName = "main" // Specify the branch name or use params.BRANCH if parameterized
                    def lastFiveCommits = sh(
                        script: "git ls-remote --heads ${gitUrl} ${branchName}",
                        returnStdout: true
                    ).trim().split("\n")
 
                    // Extract commit hashes
                    def commitChoices = lastFiveCommits.collect { line ->
                        line.split()[0]
                    }
 
                    // Prompt the user to select one of the latest commit IDs
                    def chosenCommit = input(
                        message: 'Please select a commit to run the pipeline on:',
                        parameters: [
                            choice(
                                name: 'COMMIT_ID',
                                choices: commitChoices.join("\n"),
                                description: 'Select a commit ID to build:'
                            )
                        ]
                    )
 
                    // Checkout the chosen commit
                    sh "git checkout ${chosenCommit}"
                }
            }
        }
 
        stage ('Build') {
            steps {
                // Your build steps here
            }
        }
 
        stage ('Deploy to Tomcat server') {
            steps {
                // Your deployment steps here
            }
        }
    }
}

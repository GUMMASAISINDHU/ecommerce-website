import groovy.json.JsonSlurper

// Replace 'your-github-username' and 'your-token' with appropriate values
def username = "your-github-username"
def token = "your-token"
def repository = "your-repository-name" // Specify the repository

// Fetch the user's input (prefix) from the query
def prefix = params['value']?.toLowerCase() ?: ""

// Fetch branches from the repository
def url = "https://api.github.com/repos/${username}/${repository}/branches"
def connection = new URL(url).openConnection()
connection.setRequestProperty("Authorization", "token ${token}")
def response = connection.inputStream.text
def branches = new JsonSlurper().parseText(response)

// Filter branches based on the prefix
def matchingBranches = branches.findAll { branch ->
    branch.name.toLowerCase().startsWith(prefix)
}

// Return a list of branch names that match the prefix
return matchingBranches.collect { it.name }
